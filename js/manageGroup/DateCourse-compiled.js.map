{"version":3,"sources":["DateCourse.js"],"names":[],"mappings":"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","file":"DateCourse-compiled.js","sourcesContent":["'use strict';\r\nclass DateCourse {\r\n\r\n    constructor (url, elements) {\r\n        this.getDirectionsListUrl = url;\r\n        this.defineElements(elements);\r\n        this.attachEvents();\r\n        this.directionList = [];\r\n        this.getDirectionsFromDb();\r\n    }\r\n\r\n    defineElements (elements) {\r\n        this.direction = elements.querySelector('.direction');\r\n        this.startDate = elements.querySelector('.startDate');\r\n        this.finishDate = elements.querySelector('.finishDate');\r\n        this.messageBox = elements.querySelector('.errorDate');\r\n    }\r\n\r\n    attachEvents () {\r\n        this.direction.addEventListener('change', () => {\r\n            this.processDate()\r\n        });\r\n        this.startDate.addEventListener('change', () => {\r\n            this.processDate()\r\n        });\r\n        this.startDate.addEventListener('blur', () => {\r\n            this.validateDate()\r\n        });\r\n    }\r\n\r\n    getDirectionsFromDb () {\r\n        return Frame.ajaxResponse('GET', this.getDirectionsListUrl, this.saveDirections.bind(this));\r\n    }\r\n\r\n    saveDirections(data) {\r\n        this.directionList = data;\r\n        this.initDirectionList();\r\n    }\r\n\r\n    initDirectionList () {\r\n        this.directionList.forEach((direction) => {\r\n            let opt = document.createElement('option');\r\n            opt.value = direction.id;\r\n            opt.innerHTML = direction.name;\r\n            this.direction.appendChild(opt);\r\n        });\r\n    }\r\n\r\n    validateDate () {\r\n        if (!this.startDate.value) {\r\n            this.messageBox.innerHTML = ('Please, select the start date');\r\n            this.startDate.style.borderColor = \"red\";\r\n\r\n            return false;\r\n\r\n        } else {\r\n            this.messageBox.style.display = \"none\";\r\n            this.startDate.style.borderColor = \"black\";\r\n\r\n            return true;\r\n\r\n        }\r\n    }\r\n\r\n    processDate () {\r\n        let startDate = this.startDate.value,\r\n            direction = this.direction.value,\r\n            finishDate;\r\n\r\n        finishDate = this.defineFinishDate(startDate, direction);\r\n        this.finishDate.value = this.dateToUTC(finishDate);\r\n    }\r\n\r\n    defineFinishDate (startDate, direction) {\r\n        const sPerHour = 3600,\r\n            msPerDay = 24 * sPerHour * 1000;\r\n        let start = new Date(startDate),\r\n            shift = this.getShift(direction),\r\n            saturday = 6,\r\n            sunday = 0,\r\n            finish, day;\r\n\r\n        finish = new Date(start.getTime() + shift);\r\n        day = finish.getUTCDay();\r\n\r\n        if (day === saturday) {\r\n            finish = new Date(finish.getTime() + 2 * msPerDay)\r\n        } else if (day === sunday) {\r\n            finish = new Date(finish.getTime() + msPerDay)\r\n        }\r\n\r\n        return finish;\r\n\r\n    }\r\n\r\n    getShift (direction) {\r\n        const sPerHour = 3600,\r\n            msPerDay = 24 * sPerHour * 1000,\r\n            msPerWeek = 7 * msPerDay,\r\n            courseWeek = [9, 12];\r\n        let dateInMilliseconds;\r\n\r\n        if (direction === 'MQC' || direction === 'ISTQB') {\r\n            dateInMilliseconds = courseWeek[0] * msPerWeek;\r\n        } else {\r\n            dateInMilliseconds = courseWeek[1] * msPerWeek;\r\n        }\r\n\r\n        return dateInMilliseconds;\r\n    }\r\n\r\n    dateToUTC (date) {\r\n        let yyyy, mm, dd,\r\n            out;\r\n\r\n        yyyy = date.getUTCFullYear();\r\n        mm = this.normalize(date.getUTCMonth() + 1);\r\n        dd = this.normalize(date.getUTCDate());\r\n\r\n        out = `${yyyy}-${mm}-${dd}`;\r\n\r\n        return out;\r\n    }\r\n\r\n    normalize (item) {\r\n        return item < 10? '0' + item: item;\r\n    }\r\n}\r\n"]}